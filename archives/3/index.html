<!DOCTYPE html><html lang="zh-Hans-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>conditioning on mediators 中的权衡 · Seabed</title><meta name="description" content="conditioning on mediators 中的权衡 - guro2"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="robots" content="noindex"><meta name="referrer" content="no-referrer"><link rel="icon" href="https://seabed.oss-accelerate.aliyuncs.com/favicon.png"><link rel="stylesheet" href="https://fonts.googleapis.cnpmjs.org/css2?family=Noto+Serif+SC"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/katex.min.css"><link rel="stylesheet" href="/css/apollo.css"><style media="print">header, footer { display: none } main.container { margin: 0 } .post { padding-top: 0 }</style></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="https://seabed.oss-accelerate.aliyuncs.com/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/links/" target="_self" class="nav-list-link">LINKS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">conditioning on mediators 中的权衡</h1><div class="post-info">2021年2月12日</div><div class="post-content"><p>通常教科书都会告诉我们不要去控制 (conditioning)、调整 (adjust) 或匹配 (matching) 中间变量，因为考虑到它是其 parent 与某个 confounder 的 collider，那样会造成它与 confounder 成立虚假关系，即在暴露与结局的关系中造成冲撞分层偏倚 (collider stratification bias)，不过在另一方面，对它的控制也有助于降低混杂偏倚 (confounding bias) 的水平，在两方都是有偏估计的情况下，可以根据偏倚水平作出权衡。</p>
<p>今天看到的一篇文章分别给出了暴露对结局的总效应在控制与不控制中间变量的情形下的 OLS 估计量，全文基于 Judea Pearl 的因果推断框架 (虽然我还没有怎么学过…)</p>
<a id="more"></a>
<p>考虑下图中的因果关系</p>
<p><img src="https://seabed.oss-accelerate.aliyuncs.com/QQ%E6%88%AA%E5%9B%BE20210212214845.png" alt=""></p>
<p>首先，这个总效应在理论上是</p>
<p>$$\beta_{xy}+\beta_{xm}\beta_{my}$$</p>
<p>它的有偏估计量为</p>
<p>$$\hat{\beta}_{xy}=\frac{\mathrm{Cov}(X,Y)}{\mathrm{Var}(X)}$$</p>
<p>其中有</p>
<p>$$\begin{aligned}\mathrm{Var}(X)&amp;=\beta^2_{u_1x}\mathrm{Var}(U_1)+\sigma^2_x\\\mathrm{Var}(U_1)&amp;=\sigma^2_{u_1}\\\mathrm{Cov}(X,Y)&amp;=\beta_{xy}\mathrm{Var}(X)+\beta_{xm}\beta_{my}\mathrm{Var}(X)+\beta_{u_1x}\mathrm{Var}(U_1)(\beta_{u_1y}+\beta_{u_1m}\beta_{my})\end{aligned}$$</p>
<p>所以</p>
<p>$$\begin{aligned}\hat{\beta}_{xy}&amp;=\beta_{xy}+\beta_{xm}\beta_{my}+\frac{\beta_{u_1x}\mathrm{Var}(U_1)(\beta_{u_1y}+\beta_{u_1m}\beta_{my})}{\mathrm{Var}(X)}\\&amp;=\beta_{xy}+\beta_{xm}\beta_{my}+\frac{\beta_{u_1x}\sigma^2_{u_1}(\beta_{u_1y}+\beta_{u_1m}\beta_{my})}{\beta^2_{u_1x}\sigma^2_{u_1}+\sigma^2_x}\end{aligned}\tag{1}$$</p>
<p>控制 $M$ 时，它的有偏估计量为</p>
<p>$$\hat{\beta}_{xy|m}=\frac{\mathrm{Cov}(X,Y)\mathrm{Var}(M)-\mathrm{Cov}(Y,M)\mathrm{Cov}(X,M)}{\mathrm{Var}(X)\mathrm{Var}(M)-\mathrm{Cov}(X,M)^2}\tag{2}$$</p>
<p>其中</p>
<p>$$\begin{aligned}\mathrm{Var}(M)&amp;=\beta^2_{u_1m}\mathrm{Var}(U_1)+\beta^2_{u_2m}\mathrm{Var}(U_2)+\beta^2_{xm}\mathrm{Var}(X)+2\beta_{u_1m}\beta_{xm}\mathrm{Cov}(X,U_1)\\&amp;\qquad+\sigma^2_m\\\mathrm{Var}(U_2)&amp;=\sigma^2_{u_2}\\\mathrm{Cov}(X,Y)&amp;=\beta_{xy}\mathrm{Var}(X)+\beta_{xm}\beta_{my}\mathrm{Var}(X)+\beta_{u_1x}\mathrm{Var}(U_1)(\beta_{u_1y}+\beta_{u_1m}\beta_{my})\\\mathrm{Cov}(Y,M)&amp;=\beta_{my}\mathrm{Var}(M)+\beta_{u_1m}\mathrm{Var}(U_1)\beta_{u_1y}+\beta_{u_2m}\mathrm{Var}(U_2)\beta_{u_2y}\\&amp;\qquad+\beta_{xm}\beta_{u_1x}\mathrm{Var}(U_1)\beta_{u_1y}+\beta_{xm}\mathrm{Var}(X)\beta_{xy}+\beta_{u_1m}\mathrm{Var}(U_1)\beta_{u_1x}\beta_{xy}\\\mathrm{Cov}(X,M)&amp;=\beta_{xm}\mathrm{Var}(X)+\beta_{u_1x}\mathrm{Var}(U_1)\beta_{u_1m}\\\mathrm{Cov}(X,U_1)&amp;=\beta_{u_1x}\mathrm{Var}(U_1)\end{aligned}$$</p>
<p>如果假设所有误差项等于 1，那么 $(1)$ 式可以被简化为</p>
<p>$$\hat{\beta}_{xy}=\beta_{xy}+\beta_{xm}\beta_{my}+\frac{\beta_{u_1x}(\beta_{u_1y}+\beta_{u_1m}\beta_{my})}{\beta^2_{u_1x}+1}\tag{3}$$</p>
<p>而 $(2)$ 式中的各项可以被简化为</p>
<p>$$\begin{aligned}\mathrm{Var}(X)&amp;=\beta^2_{u_1x}+1\\\mathrm{Var}(M)&amp;=\beta^2_{u_1m}+\beta^2_{u_2m}+\beta^2_{xm}(\beta^2_{u_1x}+1)+2\beta_{u_1m}\beta_{xm}\beta_{u_1x}+1\\\mathrm{Cov}(X,U_1)&amp;=\beta_{u_1x}\\\mathrm{Cov}(X,Y)&amp;=\beta_{xy}(\beta^2_{u_1x}+1)+\beta_{xm}\beta_{my}(\beta^2_{u_1x}+1)+\beta_{u_1x}(\beta_{u_1y}+\beta_{u_1m}\beta_{my})\\\mathrm{Cov}(Y,M)&amp;=\beta_{my}\mathrm{Var}(M)+\beta_{u_1m}\beta_{u_1y}+\beta_{u_2m}\beta_{u_2y}+\beta_{xm}\beta_{u_1x}\beta_{u_1y}\\&amp;\qquad+\beta_{xm}\beta_{xy}(\beta^2_{u_1x}+1)+\beta_{u_1m}\beta_{u_1x}\beta_{xy}\\\mathrm{Cov}(X,M)&amp;=\beta_{xm}(\beta^2_{u_1x}+1)+\beta_{u_1x}\beta_{u1_m}\end{aligned}$$</p>
<p>从而</p>
<p>$$\begin{aligned}\hat{\beta}_{xy|m}&amp;=\frac{\left[(\beta^2_{u_2m}+1)\beta_{xy}-\beta_{xm}\beta_{u_2m}\beta_{u_2y}\right](\beta^2_{u_1x}+1)+\beta^2_{u_1m}\beta_{xy}+(\beta^2_{u_2m}+1)\beta_{u_1x}\beta_{u_1y}}{(\beta^2_{u_1x}+1)(\beta^2_{u_2m}+1)+\beta^2_{u_1m}}\\&amp;\qquad-\frac{(\beta_{xm}\beta_{u_1y}+\beta_{u_1x}\beta_{u_2m}\beta_{u_2y})\beta_{u_1m}}{(\beta^2_{u_1x}+1)(\beta^2_{u_2m}+1)+\beta^2_{u_1m}}\end{aligned}\tag{4}$$</p>
<p>最后，不控制和控制 $M$ 时的偏倚分别是 $\hat{\beta}_{xy}-\beta_{xy}-\beta_{xm}\beta_{my}$ 和 $\hat{\beta}_{xy|m}-\beta_{xy}-\beta_{xm}\beta_{my}.$</p>
<blockquote>
<p>Groenwold, Rolf H. H.a,b; Palmer, Tom M.c,d; Tilling, Kated To Adjust or Not to Adjust? When a “Confounder” Is Only Measured After Exposure, Epidemiology: March 2021 - Volume 32 - Issue 2 - p 194-201<br>
doi: 10.1097/EDE.0000000000001312</p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/archives/2/" class="next">下一篇</a></div><div class="copyright"><p>© 2021 <a href="https://blog.seabed.ink">guro2</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/katex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.13.3/dist/mermaid.min.js"></script><script defer type="module">import renderMathInElement from"https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/contrib/auto-render.mjs";renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:1},{left:"$",right:"$",display:0}]});</script></body></html>